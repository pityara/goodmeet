<% if notice %>
  <p id="notice"><%= notice %></p>
<% end %>

<h1>Встречи</h1>
    
    <% @meetings.each do |meeting| %>
    <div class="line">

      <div class="<%= cycle('entry_l', 'entry_r') %>">
        <%=link_to image_tag(meeting.image), meeting_path(meeting)%>
        <strong><%= truncate(meeting.title, length: 12) %></strong>
        <br>
        Создатель:<%= link_to meeting.creator.user.profile.name, not_my_profile_path(meeting.creator.user) %>
        Требуемый рейтинг: <%= meeting.required_rating %>
        <br>
        Дата: <%= meeting.date %>
      </div>
    </div>
    <% end %>
    <div class="line">
      <div class='entry_l'>
        <%=link_to image_tag('meeting_add_img.jpg'), new_meeting_path %>
        <h2> Создать встречу</h2>
      </div>
    </div>
<div style='width: 800px;'>
  <div id="map" style='width: 800px; height: 400px;'></div>
</div>
<script type="text/javascript">
  handler = Gmaps.build('Google');
  handler.buildMap({ provider: {}, internal: {id: 'map'}}, function(){
    markers = handler.addMarkers([
    <% @meetings.each do |meeting| %>
    {
      "lat": <%= meeting.latitude %>,
      "lng": <%= meeting.longitude %>,
      "infowindow": "<%= meeting.address %>"
    }
  ],
  <% end %>);
  handler.bounds.extendWith(markers);
  handler.fitMapToBounds();
});
</script>

